<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÙÙˆØ§Ù„ Ù…Ø±ÙˆÙ‡ 2030</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3557/3557605.png">

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root { --primary: #10b981; --secondary: #064e3b; --bg: #f3f4f6; }
        body { font-family: 'Tajawal', sans-serif; background-color: var(--bg); -webkit-tap-highlight-color: transparent; }
        
        /* Glassmorphism Effect */
        .glass { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.3); }
        
        /* Neumorphic Shadow */
        .neu-card { border-radius: 35px; background: #ffffff; box-shadow: 10px 10px 20px #e5e7eb, -10px -10px 20px #ffffff; transition: 0.3s; }
        .neu-card:active { box-shadow: inset 5px 5px 10px #e5e7eb, inset -5px -5px 10px #ffffff; transform: scale(0.98); }

        /* Smooth Category Animation */
        .cat-active { background: var(--secondary); color: white; transform: scale(1.1); box-shadow: 0 10px 20px rgba(6, 78, 59, 0.2); }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        /* Success Animation */
        @keyframes pop { 0% { transform: scale(0.5); } 100% { transform: scale(1); } }
        .success-pop { animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    </style>
</head>
<body class="pb-32 overflow-x-hidden">

    <div id="toast" class="fixed top-10 left-1/2 -translate-x-1/2 z-[9999] glass px-8 py-4 rounded-full font-black text-sm transition-all duration-500 opacity-0 translate-y-[-100%] shadow-2xl"></div>

    <header class="p-6 pt-10">
        <div class="flex justify-between items-center mb-8">
            <div ondblclick="openCashier()" class="cursor-pointer">
                <h1 class="text-3xl font-black text-emerald-900 italic">ÙÙˆØ§Ù„ Ù…Ø±ÙˆÙ‡</h1>
                <div class="flex items-center gap-2 mt-1">
                    <span class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span>
                    <span class="text-[10px] font-bold text-emerald-600 uppercase tracking-widest">Vision 2030 Edition</span>
                </div>
            </div>
            <div class="w-14 h-14 neu-card flex items-center justify-center text-xl text-emerald-800">
                <i class="fa-solid fa-bolt"></i>
            </div>
        </div>

        <div id="tabs" class="flex gap-4 overflow-x-auto no-scrollbar py-2"></div>
    </header>

    <main class="px-6">
        <div id="grid" class="grid grid-cols-1 gap-6 pb-20"></div>
    </main>

    <div id="cartDock" onclick="openCart()" class="fixed bottom-8 left-6 right-6 h-20 glass rounded-[30px] shadow-2xl z-[500] hidden items-center justify-between px-6 border-2 border-white translate-y-32 transition-all duration-500">
        <div class="flex items-center gap-4">
            <div class="w-12 h-12 bg-emerald-900 text-white rounded-2xl flex items-center justify-center text-xl relative">
                <i class="fa-solid fa-basket-shopping"></i>
                <span id="cartCount" class="absolute -top-2 -right-2 bg-red-500 w-6 h-6 rounded-full text-[10px] flex items-center justify-center border-2 border-white">0</span>
            </div>
            <div>
                <p class="text-[10px] font-bold opacity-50 uppercase">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</p>
                <p id="cartTotal" class="text-xl font-black text-emerald-900">0ï·¼</p>
            </div>
        </div>
        <div class="bg-emerald-800 text-white px-6 py-2 rounded-xl font-bold text-sm">Ù…Ø±Ø§Ø¬Ø¹Ø©</div>
    </div>

    <div id="modal" class="fixed inset-0 z-[1000] hidden glass items-end justify-center">
        <div id="modalBox" class="bg-white w-full max-w-xl rounded-t-[50px] p-10 translate-y-full transition-all duration-500 relative shadow-2xl max-h-[90vh] overflow-y-auto">
            <button onclick="closeModal()" class="absolute top-8 left-8 text-slate-300"><i class="fa-solid fa-xmark text-2xl"></i></button>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // --- Firebase Config ---
        const firebaseConfig = {
            apiKey: "AIzaSyCcQkEMeeoIHbj_7bbU1TnidZJJOdjAx8s",
            authDomain: "fawal-c9530.firebaseapp.com",
            projectId: "fawal-c9530",
            storageBucket: "fawal-c9530.firebasestorage.app",
            messagingSenderId: "5341806694",
            appId: "1:5341806694:web:746e207ad783dbaac26da7"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // --- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© 2030 ---
        const DATA = {
            "ÙÙˆÙ„ ÙˆØ¹Ø¯Ø³": [
                {id:1, n:"ÙÙˆÙ„ Ø³Ø§Ø¯Ø©", e:"ğŸ¥£", s:{s:3, m:4, l:5, local:6}},
                {id:2, n:"ÙÙˆÙ„ Ù…Ø´ÙƒÙ„", e:"ğŸ²", s:{s:4, m:5, l:6, local:7}},
                {id:3, n:"ÙÙˆÙ„ Ù‚Ù„Ø§Ø¨Ø© Ø·Ø§ÙˆÙ‡", e:"ğŸ”¥", s:{s:4, m:5, l:6, local:7}},
                {id:5, n:"Ø¹Ø¯Ø³ Ø³Ø§Ø¯Ø©", e:"ğŸ¥£", s:{s:3, m:4, l:5, local:6}},
                {id:10, n:"Ø¹Ø¯Ø³ Ù…Ø´ÙƒÙ„", e:"ğŸ¥—", s:{s:4, m:5, l:6, local:7}},
                {id:13, n:"ØªÙˆÙ†Ø© ÙØ§Ø®Ø±Ø©", e:"ğŸŸ", s:{s:10, m:11, l:12, local:10}}
            ],
            "Ø§Ù„Ù…Ø·Ø¨Ù‚": [
                {id:23, n:"Ù…Ø·Ø¨Ù‚ Ø®Ø¶Ø§Ø±", e:"ğŸŒ®", p:5},
                {id:24, n:"Ù…Ø·Ø¨Ù‚ Ù…Ø§Ù„Ø­", e:"ğŸ§€", p:5},
                {id:26, n:"Ù…Ø·Ø¨Ù‚ Ø¬Ø¨Ù† Ø³Ø§Ø¦Ù„", e:"ğŸ¥›", p:6},
                {id:33, n:"Ù…Ø·Ø¨Ù‚ Ù†ÙˆØªÙŠÙ„Ø§", e:"ğŸ«", p:7}
            ],
            "Ø§Ù„Ø¹Ø±ÙŠÙƒØ© ÙˆØ§Ù„ÙØªØ©": [
                {id:34, n:"Ø¹Ø±ÙŠÙƒØ© Ù‚Ø´Ø·Ø© Ø¹Ø³Ù„", e:"ğŸ¯", p:12},
                {id:36, n:"Ù…Ù„ÙƒÙŠ Ù…Ø±ÙˆÙ‡", e:"ğŸ‘‘", p:16},
                {id:38, n:"Ø¹Ø±ÙŠÙƒØ© Ø¯Ø¨Ù„ Ù‚Ø´Ø·Ø©", e:"âœ¨", p:18}
            ],
            "Ø§Ù„ØªÙ…ÙŠØ³": [
                {id:56, n:"ØªÙ…ÙŠØ³ Ø¹Ø§Ø¯ÙŠ", e:"ğŸ«“", p:1},
                {id:59, n:"ØªÙ…ÙŠØ³ Ø¬Ø¨Ù†", e:"ğŸ§€", p:5},
                {id:66, n:"ØªÙ…ÙŠØ³ Ø¨Ø³ÙƒÙˆØª", e:"ğŸª", p:3}
            ]
        };

        let cart = [];
        let cat = "ÙÙˆÙ„ ÙˆØ¹Ø¯Ø³";

        window.onload = () => { renderTabs(); renderGrid(); };

        function renderTabs() {
            const h = document.getElementById('tabs');
            h.innerHTML = Object.keys(DATA).map(c => `
                <button onclick="setCat('${c}')" class="px-8 py-3 rounded-2xl whitespace-nowrap font-black transition-all ${cat===c?'cat-active':'text-emerald-900/30'}">${c}</button>
            `).join('');
        }

        function setCat(c) { cat = c; renderTabs(); renderGrid(); }

        function renderGrid() {
            const h = document.getElementById('grid');
            h.innerHTML = DATA[cat].map(i => `
                <div class="neu-card p-6 flex flex-col gap-4">
                    <div class="flex justify-between items-center">
                        <div class="flex items-center gap-4">
                            <span class="text-4xl">${i.e}</span>
                            <h3 class="font-black text-emerald-950 text-xl">${i.n}</h3>
                        </div>
                        ${i.p ? `<button onclick="add('${i.n}', ${i.p}, '${i.e}')" class="bg-emerald-900 text-white px-6 py-3 rounded-2xl font-black text-sm shadow-xl">+ ${i.p}ï·¼</button>` : ''}
                    </div>
                    ${i.s ? `<div class="grid grid-cols-2 gap-2 mt-2">${Object.entries(i.s).map(([sz, p]) => `
                        <button onclick="add('${i.n} (${sz})', ${p}, '${i.e}')" class="bg-emerald-50 p-4 rounded-2xl flex justify-between items-center text-[10px] font-black border border-emerald-100">
                            <span class="opacity-50">${sz==='s'?'ØµØºÙŠØ±':sz==='m'?'ÙˆØ³Ø·':sz==='l'?'ÙƒØ¨ÙŠØ±':'Ù…Ø­Ù„ÙŠ'}</span>
                            <span class="text-emerald-900">${p}ï·¼</span>
                        </button>`).join('')}</div>` : ''}
                </div>
            `).join('');
        }

        function add(n, p, e) {
            cart.push({n, p, e});
            updateCart();
            showToast(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${n} âœ…`);
        }

        function updateCart() {
            const c = document.getElementById('cartDock');
            const total = cart.reduce((s,i)=>s+i.p,0);
            document.getElementById('cartCount').innerText = cart.length;
            document.getElementById('cartTotal').innerText = total + "ï·¼";
            if(cart.length > 0) { c.classList.remove('hidden'); setTimeout(()=>c.classList.remove('translate-y-32'), 10); }
        }

        function openCart() {
            let h = `<h2 class="text-3xl font-black mb-8 text-emerald-950">Ø³Ù„Ø© Ø¬ÙŠØ±Ø§Ù†Ù†Ø§ ğŸ </h2>
                     <div class="space-y-4 mb-8">`;
            h += cart.map((i, idx) => `
                <div class="flex justify-between items-center bg-emerald-50/50 p-5 rounded-[25px] border border-emerald-100">
                    <div class="flex items-center gap-4"><span class="text-2xl">${i.e}</span><span class="font-black text-emerald-900">${i.n}</span></div>
                    <button onclick="remove(${idx})" class="text-red-400 w-10 h-10 neu-card flex items-center justify-center">âœ•</button>
                </div>`).join('');
            h += `</div>
                  <div class="bg-emerald-900 text-white p-8 rounded-[35px] shadow-2xl">
                    <div class="flex justify-between mb-6"><span class="opacity-70 font-bold">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨:</span><span class="text-3xl font-black">${cart.reduce((s,i)=>s+i.p,0)}ï·¼</span></div>
                    <button onclick="send()" class="w-full bg-white text-emerald-900 py-6 rounded-2xl font-black text-xl shadow-lg active:scale-95 transition">Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø·Ø¨Ø® ğŸ‘¨â€ğŸ³</button>
                  </div>`;
            openModal(h);
        }

        async function send() {
            const order = { 
                items: cart, 
                total: cart.reduce((s,i)=>s+i.p,0), 
                status: 'new', 
                time: new Date().toLocaleTimeString('ar-SA'),
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            showToast("â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ£ÙƒÙŠØ¯...");
            await db.collection("orders").add(order);
            
            openModal(`
                <div class="text-center py-10 success-pop">
                    <div class="w-24 h-24 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6 text-5xl shadow-inner">âœ“</div>
                    <h2 class="text-3xl font-black text-emerald-900 mb-2">Ø·Ù„Ø¨Ùƒ ØµØ§Ø± Ø¹Ù†Ø¯Ù†Ø§!</h2>
                    <p class="text-slate-400 font-bold mb-10">ØªÙØ¶Ù„ Ø¨Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±ØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¶ÙŠØ±...</p>
                    <button onclick="location.reload()" class="w-full bg-emerald-900 text-white py-5 rounded-3xl font-black shadow-xl">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
                </div>
            `);
            cart = []; updateCart();
        }

        function openCashier() {
            const p = prompt("Ø±Ù…Ø² Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠ:");
            if(p !== "1234") return;
            openModal(`<div id="live" class="space-y-4 pt-10">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª...</div>`);
            db.collection("orders").orderBy("createdAt", "desc").limit(10).onSnapshot(snap => {
                const l = document.getElementById('live');
                if(!l) return;
                l.innerHTML = `<h2 class="text-2xl font-black mb-6">Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø­ÙŠØ© ğŸ“¡</h2>`;
                snap.forEach(doc => {
                    const o = doc.data();
                    l.innerHTML += `
                        <div class="neu-card p-6 border-r-8 ${o.status==='new'?'border-blue-600':'border-slate-200'}">
                            <div class="flex justify-between font-black mb-2 text-sm text-blue-800"><span>Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ #${doc.id.slice(0,4)}</span><span>${o.total}ï·¼</span></div>
                            <div class="text-[10px] opacity-40 mb-4">${o.time}</div>
                            <div class="space-y-1 mb-4">${o.items.map(it => `<div class="text-xs font-bold text-slate-600">â€¢ ${it.n}</div>`).join('')}</div>
                            ${o.status === 'new' ? `<button onclick="approve('${doc.id}')" class="w-full bg-emerald-600 text-white py-3 rounded-xl font-bold">ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø¢Ù†</button>` : `<span class="text-emerald-500 font-bold text-xs italic">Ù‚ÙŠØ¯ Ø§Ù„ØªØ­Ø¶ÙŠØ±...</span>`}
                        </div>`;
                });
            });
        }

        async function approve(id) { await db.collection("orders").doc(id).update({status: 'preparing'}); new Audio('https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3').play(); }
        function remove(idx) { cart.splice(idx, 1); openCart(); updateCart(); if(cart.length===0) closeModal(); }
        function openModal(c) { document.getElementById('modalContent').innerHTML = c; document.getElementById('modal').style.display = 'flex'; setTimeout(()=>document.getElementById('modalBox').classList.remove('translate-y-full'), 10); }
        function closeModal() { document.getElementById('modalBox').classList.add('translate-y-full'); setTimeout(()=>document.getElementById('modal').style.display = 'none', 400); }
        function showToast(m) { const t = document.getElementById('toast'); t.innerText = m; t.classList.remove('opacity-0', 'translate-y-[-100%]'); setTimeout(()=>t.classList.add('opacity-0', 'translate-y-[-100%]'), 2000); }
    </script>
</body>
</html>
