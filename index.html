
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÙÙˆØ§Ù„ Ù…Ø±ÙˆÙ‡ - Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø³Ù…ÙŠ</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>

    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #f8fafc; overflow-x: hidden; }
        .h-red { color: #ff3252; }
        .h-bg-red { background-color: #ff3252; }
        .h-card { background: white; border-radius: 20px; transition: 0.3s; cursor: pointer; border: 1px solid #f1f5f9; }
        .h-card:active { transform: scale(0.96); }
        .category-pill { transition: 0.3s; white-space: nowrap; }
        .category-pill.active { background: #ff3252; color: white; border-color: #ff3252; box-shadow: 0 4px 12px rgba(255, 50, 82, 0.3); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="pb-32">

    <div id="trackingBanner" class="hidden bg-emerald-600 text-white p-4 sticky top-0 z-[2000] shadow-lg animate-bounce-short">
        <div class="flex justify-between items-center max-w-lg mx-auto">
            <div class="flex items-center gap-3">
                <i class="fa-solid fa-truck-fast animate-pulse"></i>
                <div>
                    <p class="text-[10px] font-bold opacity-80 uppercase">Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ</p>
                    <p id="orderStatusText" class="text-sm font-black italic">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ¬Ù‡ÙŠØ² ÙÙŠ Ø§Ù„Ù…Ø·Ø¹Ù…...</p>
                </div>
            </div>
            <span class="text-xs font-black bg-white/20 px-3 py-1 rounded-full">15-20 Ø¯Ù‚ÙŠÙ‚Ø©</span>
        </div>
    </div>

    <header class="bg-white p-5 shadow-sm sticky top-0 z-[1000] border-b border-gray-100">
        <div class="flex justify-between items-center mb-5">
            <div class="flex items-center gap-3">
                <div class="w-11 h-11 h-bg-red rounded-2xl flex items-center justify-center text-white shadow-lg"><i class="fa-solid fa-location-dot"></i></div>
                <div>
                    <h1 class="text-[10px] text-gray-400 font-black uppercase">Ø§Ù„ØªÙˆØµÙŠÙ„ Ø¥Ù„Ù‰</h1>
                    <p class="text-sm font-black text-slate-800">Ø­ÙŠ Ø¨Ø¯Ø±ØŒ Ø§Ù„Ø¯Ù…Ø§Ù… <i class="fa-solid fa-chevron-down text-[10px] h-red"></i></p>
                </div>
            </div>
            <div class="bg-gray-50 w-11 h-11 rounded-full flex items-center justify-center text-gray-400"><i class="fa-solid fa-heart"></i></div>
        </div>

        <div id="categoryTabs" class="flex gap-2 overflow-x-auto no-scrollbar py-2"></div>
    </header>

    <main class="p-4">
        <div id="nbrBtn" onclick="toggleNeighborMode()" class="mb-8 p-6 rounded-[30px] bg-slate-900 text-white flex justify-between items-center relative overflow-hidden group transition-all">
            <div class="relative z-10">
                <h3 class="font-black text-xl italic mb-1">ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠØŸ ğŸ</h3>
                <p id="nbrLabel" class="text-xs font-bold text-slate-400 uppercase tracking-widest">ÙÙ‚Ø· Ù„Ø³ÙƒØ§Ù† Ø­ÙŠ Ø¨Ø¯Ø±</p>
            </div>
            <i class="fa-solid fa-bolt text-4xl opacity-10 absolute left-4 group-hover:scale-125 transition-transform h-red"></i>
        </div>

        <div id="itemsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
    </main>

    <div id="floatingCart" onclick="openCartModal()" class="fixed bottom-6 left-4 right-4 h-bg-red text-white p-5 rounded-[28px] shadow-2xl z-[3000] hidden justify-between items-center transform transition-all active:scale-95">
        <div class="flex items-center gap-4">
            <div class="bg-white h-red w-10 h-10 rounded-2xl flex items-center justify-center font-black shadow-inner" id="cartCount">0</div>
            <span class="font-black text-lg">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span>
        </div>
        <span id="floatingTotal" class="text-2xl font-black">0ï·¼</span>
    </div>

    <div id="mainModal" class="fixed inset-0 z-[4000] hidden bg-slate-900/60 backdrop-blur-md items-end justify-center">
        <div class="bg-white w-full max-w-lg rounded-t-[45px] p-8 max-h-[90vh] overflow-y-auto shadow-2xl transition-all translate-y-0">
            <div class="w-12 h-1.5 bg-gray-200 rounded-full mx-auto mb-8"></div>
            <div id="modalContent"></div>
            <button onclick="closeModal()" class="w-full mt-6 text-slate-400 font-bold text-sm tracking-widest">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©</button>
        </div>
    </div>

    <script>
        // Ø¯Ù…Ø¬ ÙƒØ§Ù…Ù„ Ø§Ù„Ø£ØµÙ†Ø§Ù Ù…Ù† Ù…Ù„Ù index.html Ø§Ù„Ø£ØµÙ„ÙŠ
        const DB = {
            "Ø§Ù„ÙˆØ¬Ø¨Ø§Øª": [
                {id:1, name:"ÙÙˆÙ„ Ø³Ø§Ø¯Ø©", kw:"beans", sizes:{s:3, m:4, l:5, local:6}},
                {id:2, name:"ÙÙˆÙ„ Ø·Ø§ÙˆÙ‡", kw:"hot-beans", sizes:{s:4, m:5, l:6, local:7}},
                {id:5, name:"Ø¹Ø¯Ø³ Ø³Ø§Ø¯Ø©", kw:"lentils", sizes:{s:3, m:4, l:5, local:6}},
                {id:13, name:"ØªÙˆÙ†Ø© Ø·Ø§ÙˆÙ‡", kw:"tuna", sizes:{s:10, m:11, l:12, local:10}},
                {id:14, name:"Ø´ÙƒØ´ÙˆÙƒØ© Ø¹Ø§Ø¯ÙŠØ©", kw:"eggs", sizes:{s:6, m:7, l:8, local:7}}
            ],
            "Ø§Ù„Ù…Ø·Ø¨Ù‚": [
                {id:23, name:"Ù…Ø·Ø¨Ù‚ Ø®Ø¶Ø§Ø±", kw:"pastry", price:5},
                {id:32, name:"Ù…Ø·Ø¨Ù‚ Ø¬Ø¨Ù† Ø­Ù„Ùˆ", kw:"cheese-pastry", price:6},
                {id:33, name:"Ù…Ø·Ø¨Ù‚ Ù†ÙˆØªÙŠÙ„Ø§", kw:"nutella", price:7}
            ],
            "Ø§Ù„Ø¹Ø±ÙŠÙƒØ© ÙˆØ§Ù„ÙØªØ©": [
                {id:34, name:"Ù‚Ø´Ø·Ø© Ø¹Ø³Ù„", kw:"honey-dessert", price:12},
                {id:36, name:"Ø¹Ø±ÙŠÙƒØ© Ù…Ù„ÙƒÙŠ", kw:"royal", price:16},
                {id:38, name:"Ø¹Ø±ÙŠÙƒØ© Ù…Ø±ÙˆÙ‡", kw:"special", price:18}
            ],
            "Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª": [
                {id:48, name:"ÙƒØ¨Ø¯Ø©", kw:"liver-sandwich", sizes:{samoli:4, fatira:5}},
                {id:52, name:"ØªÙ‚Ø§Ø·ÙŠØ¹", kw:"meat-sandwich", sizes:{samoli:4, fatira:5}}
            ],
            "Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª": [
                {id:74, name:"Ø´Ø§ÙŠ Ø¨Ø§Ù„Ø­Ù„ÙŠØ¨", kw:"karak", price:2},
                {id:71, name:"Ù…Ø§Ø¡", kw:"water", price:1}
            ]
        };

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠØ±Ø¨ÙŠØ³ (Ø§Ø³ØªØ¨Ø¯Ù„Ù‡Ø§ Ø¨Ù…ÙØ§ØªÙŠØ­Ùƒ)
        const firebaseConfig = { apiKey: "...", databaseURL: "...", projectId: "..." };
        // firebase.initializeApp(firebaseConfig);
        // const database = firebase.database();

        let cart = [];
        let currentCategory = "Ø§Ù„ÙˆØ¬Ø¨Ø§Øª";
        let isNeighbor = false;

        function renderTabs() {
            const tabs = document.getElementById('categoryTabs');
            tabs.innerHTML = Object.keys(DB).map(cat => `
                <button onclick="setCategory('${cat}')" class="category-pill px-6 py-2.5 rounded-full border border-gray-200 font-black text-sm ${cat === currentCategory ? 'active' : 'bg-white text-slate-500'}">
                    ${cat}
                </button>
            `).join('');
        }

        function renderItems() {
            const grid = document.getElementById('itemsGrid');
            grid.innerHTML = DB[currentCategory].map(item => `
                <div class="h-card overflow-hidden" onclick="openOptions(${item.id})">
                    <img src="https://images.unsplash.com/photo-1541518763531-4650629d5bca?w=400&q=80" class="w-full h-44 object-cover">
                    <div class="p-5 flex justify-between items-center">
                        <div>
                            <h3 class="font-black text-slate-800 text-lg">${item.name}</h3>
                            <p class="text-[10px] text-slate-400 font-bold uppercase tracking-tighter">Ø£ÙØ¶Ù„ Ø®ÙŠØ§Ø± Ù„Ù„ÙØ·ÙˆØ±</p>
                        </div>
                        <span class="h-red font-black text-lg">${item.price ? item.price + 'ï·¼' : 'ØªØ®ØµÙŠØµ'}</span>
                    </div>
                </div>
            `).join('');
        }

        function openOptions(id) {
            const item = DB[currentCategory].find(i => i.id === id);
            let content = `<h2 class="text-2xl font-black text-center mb-8">${item.name}</h2>`;
            
            if (item.sizes) {
                content += Object.entries(item.sizes).map(([s, p]) => `
                    <div class="flex justify-between items-center p-5 border border-slate-100 rounded-[25px] mb-3 bg-slate-50/50">
                        <span class="font-black text-slate-700">${getSizeName(s)} (${p}ï·¼)</span>
                        <div class="flex items-center gap-4 bg-white p-2 rounded-2xl shadow-sm">
                            <button onclick="updateQty(${item.id}, -1, '${item.name}', ${p}, '${s}')" class="w-9 h-9 rounded-xl bg-gray-100 text-slate-400 font-black">-</button>
                            <span class="font-black w-4 text-center">${getQty(item.id, s)}</span>
                            <button onclick="updateQty(${item.id}, 1, '${item.name}', ${p}, '${s}')" class="w-9 h-9 rounded-xl h-bg-red text-white shadow-lg">+</button>
                        </div>
                    </div>
                `).join('');
            } else {
                content += `
                    <div class="flex justify-between items-center p-5 border border-slate-100 rounded-[25px] bg-slate-50/50">
                        <span class="font-black text-slate-700">Ø§Ù„Ø³Ø¹Ø±: ${item.price}ï·¼</span>
                        <div class="flex items-center gap-4 bg-white p-2 rounded-2xl shadow-sm">
                            <button onclick="updateQty(${item.id}, -1, '${item.name}', ${item.price})" class="w-9 h-9 rounded-xl bg-gray-100">-</button>
                            <span class="font-black w-4 text-center">${getQty(item.id, 'default')}</span>
                            <button onclick="updateQty(${item.id}, 1, '${item.name}', ${item.price})" class="w-9 h-9 rounded-xl h-bg-red text-white">+</button>
                        </div>
                    </div>
                `;
            }
            content += `<button onclick="closeModal()" class="w-full h-bg-red text-white py-5 rounded-[25px] font-black mt-10 shadow-xl shadow-red-200">ØªÙ… Ø§Ù„Ø¥Ø®ØªÙŠØ§Ø±</button>`;
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('mainModal').style.display = 'flex';
        }

        function updateQty(id, delta, name, price, size = 'default') {
            const key = `${id}-${size}`;
            const idx = cart.findIndex(i => i.key === key);
            if (idx > -1) {
                cart[idx].qty += delta;
                if (cart[idx].qty <= 0) cart.splice(idx, 1);
            } else if (delta > 0) {
                cart.push({ id, key, name: size !== 'default' ? `${name} (${getSizeName(size)})` : name, price, qty: 1 });
            }
            updateCartDisplay();
            openOptions(id);
        }

        function updateCartDisplay() {
            const count = cart.reduce((s, i) => s + i.qty, 0);
            const total = cart.reduce((s, i) => s + (i.price * i.qty), 0);
            document.getElementById('floatingCart').style.display = count > 0 ? 'flex' : 'none';
            document.getElementById('cartCount').innerText = count;
            document.getElementById('floatingTotal').innerText = total + "ï·¼";
        }

        function openCartModal() {
            const total = cart.reduce((s, i) => s + (i.price * i.qty), 0);
            let content = `<h2 class="text-2xl font-black mb-8">Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2><div class="space-y-4 mb-10">`;
            cart.forEach(i => {
                content += `<div class="flex justify-between items-center pb-4 border-b border-slate-50 font-bold">
                    <span>${i.name} Ã— ${i.qty}</span>
                    <span class="h-red font-black">${i.price * i.qty} ï·¼</span>
                </div>`;
            });
            content += `</div><button onclick="sendOrderToServer()" class="w-full bg-green-500 text-white py-6 rounded-[30px] font-black text-xl shadow-xl shadow-green-100 flex items-center justify-center gap-3">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡ <i class="fa-solid fa-paper-plane"></i></button>`;
            document.getElementById('modalContent').innerHTML = content;
        }

        function sendOrderToServer() {
            const orderData = {
                id: Date.now(),
                items: cart,
                total: cart.reduce((s, i) => s + (i.price * i.qty), 0),
                status: 'pending',
                time: new Date().toLocaleTimeString('ar-SA')
            };

            // Ù…Ø­Ø§ÙƒØ§Ø© Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø·Ø¹Ù… (ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¨Ø· Firebase Ù‡Ù†Ø§)
            localStorage.setItem('last_fawal_order', JSON.stringify(orderData));
            
            alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØµÙŠÙ„ ÙÙŠ ØºØ¶ÙˆÙ† 20 Ø¯Ù‚ÙŠÙ‚Ø©.");
            cart = []; updateCartDisplay(); closeModal();
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø±ÙŠØ· Ø§Ù„ØªØªØ¨Ø¹
            document.getElementById('trackingBanner').classList.remove('hidden');
        }

        function getSizeName(s) { return {s:'ØµØºÙŠØ±', m:'ÙˆØ³Ø·', l:'ÙƒØ¨ÙŠØ±', local:'Ù…Ø­Ù„ÙŠ', samoli:'ØµØ§Ù…ÙˆÙ„ÙŠ', fatira:'ÙØ·ÙŠØ±Ø©'}[s] || s; }
        function getQty(id, size) { const it = cart.find(i => i.key === `${id}-${size}`); return it ? it.qty : 0; }
        function setCategory(cat) { currentCategory = cat; renderTabs(); renderItems(); }
        function closeModal() { document.getElementById('mainModal').style.display = 'none'; }
        window.onload = () => { renderTabs(); renderItems(); };
    </script>
</body>
</html>
