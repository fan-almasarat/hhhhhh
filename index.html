<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>فوال مروه - طلبات العميل</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #f8f9fa; }
        .h-red { color: #ff3252; }
        .h-bg-red { background-color: #ff3252; }
        .h-card { background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.05); cursor: pointer; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="pb-32">

    <header class="bg-white p-4 sticky top-0 z-[100] shadow-sm">
        <div class="flex justify-between items-center mb-4">
            <div class="flex items-center gap-2">
                <div class="w-10 h-10 h-bg-red rounded-full flex items-center justify-center text-white"><i class="fa-solid fa-location-dot"></i></div>
                <div>
                    <h1 class="text-[10px] text-gray-400 font-bold">التوصيل إلى</h1>
                    <p class="text-sm font-black text-gray-800">حي بدر، الدمام</p>
                </div>
            </div>
            <div class="bg-red-50 px-3 py-1 rounded-full text-[10px] font-black h-red">
                ⏱ 15 - 20 دقيقة
            </div>
        </div>
        <div id="categoryTabs" class="flex gap-2 overflow-x-auto no-scrollbar py-2"></div>
    </header>

    <main class="p-4" id="itemsGrid"></main>

    <div id="floatingCart" onclick="openCartModal()" class="fixed bottom-6 left-4 right-4 h-bg-red text-white p-4 rounded-2xl shadow-2xl z-[1000] hidden justify-between items-center">
        <div class="flex items-center gap-3">
            <div class="bg-white h-red px-2 rounded-lg font-black" id="cartCount">0</div>
            <span class="font-black">عرض الطلب</span>
        </div>
        <span id="floatingTotal" class="text-lg font-black">0﷼</span>
    </div>

    <div id="mainModal" class="fixed inset-0 z-[2000] hidden bg-black/60 backdrop-blur-sm items-end justify-center">
        <div class="bg-white w-full max-w-lg rounded-t-[30px] p-6 max-h-[85vh] overflow-y-auto">
            <div id="modalContent"></div>
            <button onclick="closeModal()" class="w-full mt-4 text-gray-400 font-bold">إغلاق</button>
        </div>
    </div>

    <script>
        // قاعدة البيانات الكاملة من ملفك
        const DB = {
            "الوجبات": [
                {id:1, name:"فول سادة", kw:"fava-beans", sizes:{s:3, m:4, l:5, local:6}},
                {id:5, name:"عدس سادة", kw:"lentils", sizes:{s:3, m:4, l:5, local:6}},
                {id:14, name:"شكشوكة", kw:"shakshuka", sizes:{s:6, m:7, l:8, local:7}}
            ],
            "المطبق": [
                {id:23, name:"مطبق خضار", kw:"pastry", price:5},
                {id:33, name:"نوتيلا", kw:"chocolate-pancake", price:7}
            ],
            "العريكة": [
                {id:36, name:"ملكي", kw:"honey-dessert", price:16},
                {id:38, name:"عريكة مروة", kw:"dates-cream", price:18}
            ],
            "المشروبات": [
                {id:74, name:"شاي بالحليب", kw:"tea-milk", price:2}
            ]
        };

        let cart = [];
        let currentCategory = "الوجبات";

        function renderTabs() {
            const tabs = document.getElementById('categoryTabs');
            tabs.innerHTML = Object.keys(DB).map(cat => `
                <button onclick="setCategory('${cat}')" class="px-6 py-2 rounded-full font-bold whitespace-nowrap ${cat === currentCategory ? 'h-bg-red text-white' : 'bg-gray-100 text-gray-500'}">
                    ${cat}
                </button>
            `).join('');
        }

        function renderItems() {
            const grid = document.getElementById('itemsGrid');
            grid.innerHTML = `<div class="grid grid-cols-1 gap-6">` + DB[currentCategory].map(item => `
                <div class="h-card" onclick="openOptions(${item.id})">
                    <img src="https://images.unsplash.com/photo-1541518763531-4650629d5bca?q=80&w=400&auto=format&fit=crop" class="w-full h-40 object-cover" 
                         onload="this.src='https://source.unsplash.com/400x300/?${item.kw},food'">
                    <div class="p-4 flex justify-between items-center">
                        <h3 class="font-black text-gray-800">${item.name}</h3>
                        <span class="h-red font-black">${item.price ? item.price + '﷼' : 'تخصيص'}</span>
                    </div>
                </div>
            `).join('') + `</div>`;
        }

        function setCategory(cat) { currentCategory = cat; renderTabs(); renderItems(); }

        function openOptions(id) {
            const item = DB[currentCategory].find(i => i.id === id);
            let content = `<h2 class="text-2xl font-black mb-6 text-center">${item.name}</h2>`;
            if (item.sizes) {
                content += Object.entries(item.sizes).map(([s, p]) => `
                    <div class="flex justify-between items-center p-4 border rounded-2xl mb-2">
                        <span class="font-bold">${s === 's' ? 'صغير' : s === 'm' ? 'وسط' : s === 'l' ? 'كبير' : 'محلي'} - ${p}﷼</span>
                        <button onclick="addToCart('${item.name} (${s})', ${p})" class="h-bg-red text-white px-6 py-2 rounded-xl font-bold">+</button>
                    </div>`).join('');
            } else {
                content += `<button onclick="addToCart('${item.name}', ${item.price})" class="w-full h-bg-red text-white py-5 rounded-2xl font-black">إضافة - ${item.price}﷼</button>`;
            }
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('mainModal').style.display = 'flex';
        }

        function addToCart(name, price) {
            cart.push({ name, price });
            updateCart();
            closeModal();
        }

        function updateCart() {
            const total = cart.reduce((s, i) => s + i.price, 0);
            document.getElementById('floatingCart').style.display = cart.length > 0 ? 'flex' : 'none';
            document.getElementById('cartCount').innerText = cart.length;
            document.getElementById('floatingTotal').innerText = total + "﷼";
        }

        function openCartModal() {
            const total = cart.reduce((s, i) => s + i.price, 0);
            let content = `<h2 class="text-xl font-black mb-4">سلة الطلبات</h2>`;
            cart.forEach(i => content += `<div class="flex justify-between py-2 border-b text-sm"><span>${i.name}</span><b>${i.price}﷼</b></div>`);
            content += `<button onclick="confirmOrder()" class="w-full h-bg-red text-white py-5 rounded-2xl font-black mt-6">تأكيد وإرسال للمطعم</button>`;
            document.getElementById('modalContent').innerHTML = content;
        }

        function confirmOrder() {
            const orderData = { id: Date.now(), items: cart, total: cart.reduce((s, i) => s + i.price, 0), time: new Date().toLocaleTimeString('ar-SA') };
            localStorage.setItem('newOrder', JSON.stringify(orderData));
            alert("تم إرسال الطلب بنجاح!");
            cart = []; updateCart(); closeModal();
        }

        function closeModal() { document.getElementById('mainModal').style.display = 'none'; }
        window.onload = () => { renderTabs(); renderItems(); };
    </script>
</body>
</html>
